# Proposal Prepper (Contract Checker) - NSF PAPPG Compliance Validation
# Federated Mesh microservice deployment configuration

[build]
builder = "NIXPACKS"

# Web Service (Next.js)
[deploy]
startCommand = "pnpm --filter web start"
healthcheckPath = "/api/health"
healthcheckTimeout = 100
restartPolicyType = "ON_FAILURE"

[environments.production]
variables = { 
  NODE_ENV = "production",
  STRANDS_AGENT_URL = "${{RAILWAY_STATIC_URL}}:8080",
  GENKIT_AGENT_URL = "${{RAILWAY_STATIC_URL}}:8081"
}

[environments.staging]
variables = { 
  NODE_ENV = "staging",
  STRANDS_AGENT_URL = "${{RAILWAY_STATIC_URL}}:8080",
  GENKIT_AGENT_URL = "${{RAILWAY_STATIC_URL}}:8081"
}

# Note: Additional services (strands-agent, genkit-service) 
# will be deployed as separate Railway services